{% load static %}

<!-- Painel da Questão -->
<div class="receipe-content-area">
    <div class="container">
        <div class="row">
            <div class="col-8 col-sm col-md-8">
                <div class="receipe-headline my-5">
                    <span>{{ pergunta.data_pergunta}}</span>
                    <div class="receipe-duration">
                        <h6>Instituição: {{pergunta.faculdade}}</h6>
                        <h6>Disciplina: {{pergunta.disciplina}}</h6>
                        <h6> Postado por : {{usuario_pergunta}}</h6> em {{pergunta.date_pergunta|date:'d/m/Y'  }} 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Area smartphone -->

<div class="container invisible-lg" style="max-width:90%; min-width:60%; border: 1px solid #e0dede; border-radius: 10px; background: whitesmoke">
    <div class="col col-sm col-lg-10" style="max-width: fit-content; padding-top:1%">
        <div style="max-width:100%; text-align: justify;">
            <p style="color: #af92dc;font-weight: bold  ;">Pergunta:<br>
            <p style="color: #4d2d2d">{{pergunta.pergunta}} </p>
        </div>
    </div>
</div>


<!-- Renderiza este bloco caso não tenha comentários ainda -->
{% if pergunta.comentario == '' %}
    <div class="container invisible-lg">
        <div class="col" >
            <!-- Se ainda não houver, verifica se o usuário logado é assinante -->
            {% if usuario_logado_assinante != None %}
                <form action="{% url 'form_comentar' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div style="width: 100%;padding-left:0%;">
                        <label for="file"><b> <br> Deixe seu comentário:</b></label>
                        <textarea class="form-control" name="comentario" cols="100" rows="10"></textarea>
                    </div>
                    
                    <div class="row row-sm row-lg-4">

                        <div class="col col-sm col-lg-4">&nbsp;</div>

                        <div class="col col-sm col-lg-4">

                            <div class="text-center" style="width:100%;">
                                <button class="btn delicious-btn mt-30" type="submit">Responder</button>
                            </div>

                            <div><input type="hidden" name="teste" value= "{{pergunta.id}}"></input>&nbsp;</div>

                            <div class="text-center"  style="width:100%;">
                                    {% include 'partials/_recaptcha.html' %}
                            </div>

                        </div>

                        <div class="col col-sm col-lg-4">&nbsp;</div>
  
                    </div>
                </form>
            {% endif %}
        </div>
    </div>
{% endif %}


<!-- Renderiza este bloco caso já tenha comentários -->
{% if pergunta.comentario != '' %}
    <br>
    <div class="container invisible-lg">
        <div>
            <!-- Então há comentário feito -->
                <hr> <center><b><h3>COMENTÁRIO</h4></b><br></center>
            <!-- Insere dados do assinante que fez o comentário -->
            {% if usuario_assinante_comentario.mensalidade == True %}
                {% include 'partials/_pub_pergunta.html' %}
            {% else %}
                Comentário de {{usuario_anonimo}}
            {% endif %}    
            <div class="receipe-content-area" style="max-width:60%; text-align: left; font-weight: bold">
                <!-- <br><br>Veja o comentário feito pelo assessor:<br><br> -->
            </div>
        </div>
    </div>

    <!-- Comentário feito pelo assessor -->
    <div class="container invisible-lg" style="max-width:90%; margin-top: 30px; min-height:100px;border: 1px solid #e0dede; border-bottom: 0px  solid #e0dede; border-radius: 10px 10px 0px 0px ; padding-bottom:5px ; background: whitesmoke">
        <div class="col col-sm">
            <div style="max-width:100%; text-align: justify;position: relative; padding-top: 2%;">
                <p style="color: #af92dc;font-weight: bold  ;">Resposta:<br>
                <p style="color: #4d2d2d"></p> {{ pergunta.comentario }} Coloque no fogo à temperatura normal. As propriedades antiaderentes do revestimento são afetadas pelo superaquecimento repetido, portanto, é recomendável reduzir o fogo após 2 ou 3 minutos, caso você coloque a parte vazia no fogo.
                - Você pode utilizar utensílios de metal, desde que não sejam afiados (não use misturadores).
                - Após o uso, lave-as com água e sabão usando uma esponja, um pano macio ou uma escova de náilon.</p>
            </div>
        </div>
    </div>

    <!-- Inserção botão like -->
    <div class="container invisible-lg" style="margin: left 5%; background-color: white; margin-top: -0px; width: 90%;border: 1px  solid #e0dede; border-top: 0px  solid #e0dede;border-radius:0px 0px 20px 20px;">
        <div>
            {% include 'partials/_mylike.html' %}
        </div>
    </div>
{% endif %}

<div class="invisible-lg">
{% include 'partials/_btn_revisao.html' %}
</div>

<!-- Espaço para publicidade do Assessor, não deve aparecer para outros assessores -->
{% if assinante_random != None %}
<div class="invisible-lg" style="padding-bottom: 90px">
    <div class="receipe-content-area" style="width:90%; text-align: left; font-weight: bold; padding-left:15px; padding-top: 50px;">
        {% if pergunta.comentario == '' %}
            Ninguém respondeu essa pergunta, mas não se preocupe, entre em contato com o Assessor para te ajudar:<br>
        {% else %}
            Caso ainda tenha dúvidas, entre em contato com o Assessor:
        {% endif %}
        <br><br>
    </div>
    {% include 'partials/_pub_pergunta_random.html' %}
</div>

{% endif %}

<!-- End Area smartphone -->  

<!-- Area Desktop -->

<div class="container invisible-sm" style="max-width:75%; min-width:60%; border: 1px solid #e0dede; border-radius: 10px; background: whitesmoke">
    <div class="col col-sm col-lg-10" style="max-width: fit-content; padding-top:1%">
        <div style="max-width:100%; text-align: justify;">
            <p style="color: #936bd0;font-weight: bold  ;">Pergunta:<br>
            <p style="color: #4d2d2d">{{pergunta.pergunta}} </p>
        </div>
    </div>
</div>

<!-- Renderiza este bloco caso não tenha comentários ainda -->
{% if pergunta.comentario == '' %}
    <div class="container invisible-sm" style="width:80%;">
        <div class="col" >
            <!-- Se ainda não houver, verifica se o usuário logado é assinante -->
            {% if usuario_logado_assinante != None %}
                <form action="{% url 'form_comentar' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div style="width: 100%;padding-left:0%;">
                        <label for="file"><b> <br> Deixe seu comentário:</b></label>
                        <textarea class="form-control" name="comentario" cols="100" rows="10"></textarea>
                    </div>
                    
                    <div class="row row-sm row-lg-4">

                        <div class="col col-sm col-lg-4">&nbsp;</div>

                        <div class="col col-sm col-lg-4">

                            <div class="text-center" style="width:100%;">
                                <button class="btn delicious-btn mt-30" type="submit">Responder</button>
                            </div>

                            <div><input type="hidden" name="teste" value= "{{pergunta.id}}"></input>&nbsp;</div>

                            <div class="text-center"  style="width:100%;">
                                    {% include 'partials/_recaptcha.html' %}
                            </div>

                        </div>

                        <div class="col col-sm col-lg-4">&nbsp;</div>
  
                    </div>
                </form>
            {% endif %}
        </div>
    </div>
{% endif %}


<!-- Renderiza este bloco caso já tenha comentários -->
{% if pergunta.comentario != '' %}
    <br>
    <div class="container invisible-sm">
        <div>
            <!-- Então há comentário feito -->
                <hr> <center><b><h3>COMENTÁRIO</h4></b><br></center>
            <!-- Insere dados do assinante que fez o comentário -->
            {% if usuario_assinante_comentario %}
                {% include 'partials/_pub_pergunta.html' %}
            {% else %}
                Comentário Anônimo
            {% endif %}    
            <div class="receipe-content-area" style="max-width:60%; text-align: left; font-weight: bold">
            </div>
        </div>
    </div>
{% endif %}



    
    <!-- Espaço para publicidade do Assessor, não deve aparecer para outros assessores -->
    {% if assinante_random != None %}
<div class="container" style="width:80%;padding-bottom:150px;">
    <div class="invisible-sm" style="padding-bottom: 10px">
        <div class="receipe-content-area" style="width:90%; text-align: left; font-weight: bold; padding-left:15px; padding-top: 10px;">
            {% if pergunta.comentario == '' %}
            <br><br> Ninguém respondeu essa pergunta, mas não se preocupe, entre em contato com o Assessor para te ajudar:<br>
            {% else %}
                <br><hr>
                Caso ainda tenha dúvidas, entre em contato com o Assessor:
            {% endif %}
            <br><br>
        </div>
        {% include 'partials/_pub_pergunta_random.html' %}
    </div>
</div>
    
    {% endif %}








<!-- End Area Desktop -->

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
   $('a.likin').click(function(){
     $.ajax({
         type: "POST",
         url: "{% url 'curtir' %}",
         data: {'content_id': $(this).attr('name'),
               'operation':'like_submit',
               csrfmiddlewaretoken: "{{ csrf_token }}"
         },
         success: function(response) {
               selector = document.getElementsByName(response.content_id);
                       if(response.liked==true){
                         $(selector).css("color","red");
                       }
                       else if(response.liked==false){
                         $(selector).css("color","black");
                       }
         }
     })
   })
   
   </script>